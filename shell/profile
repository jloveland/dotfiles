# open man pages in Preview.app
if [ -d "/Applications/Preview.app" ]
then
  pman () {
    man -t "$@" |
    ( which ps2pdf &> /dev/null && ps2pdf - - || cat) |
    open -f -a /Applications/Preview.app
  }
fi

# add a poor facsimile for Linux's `free` if we're on Mac OS
if ! type free > /dev/null 2>&1 && [[ "$(uname -s)" == 'Darwin' ]]
then
  alias free="top -s 0 -l 1 -pid 0 -stats pid | grep '^PhysMem: ' | cut -d : -f 2- | tr ',' '\n'"
fi

# handy aliases
alias timestamp='gawk "{now=strftime(\"%F %T \"); print now \$0; fflush(); }"'

# check for window resizing whenever the prompt is displayed
shopt -s checkwinsize

# set JAVA_HOME if on Mac OS
if [ -z "$JAVA_HOME" -a -d /System/Library/Frameworks/JavaVM.framework/Home ]
then
  export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
fi

# load Homebrew's shell completion
if which brew &> /dev/null && [ -f "$(brew --prefix)/Library/Contributions/brew_bash_completion.sh" ]
then
  source "$(brew --prefix)/Library/Contributions/brew_bash_completion.sh"
fi

# make sure ~/bin is the most preferred in PATH
export PATH="$HOME/bin:$PATH"

# load local shell configuration if present
if [[ -f ~/.bashrc.local ]]
then
   source ~/.bashrc.local
fi
